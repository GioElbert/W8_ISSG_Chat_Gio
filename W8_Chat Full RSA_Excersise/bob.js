const crypto = require('crypto');  

const alicePublicKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsEBpMGudsm/S711JAAHU
dxOlpHeRLGBE1SSLb2YYIFbKT+Vk3dQdV4ksskbX7KKPAfuuYT3eoZrNAmeXz1Xv
Iqu46kU/kRI/+ie7NC4iw3IfPylp6+N8pLUrHdFE7s5kT7AhHbSQRZZ29+C+Yh6v
2Ge+id90C+iEWt6vhciYIeQWarsDcGvXPbYbfz/lI429LI+D2Kk7DsnlV1glefnZ
Lj+UFrDaYXcVCtik9QY/P8xfM9OTsHUcobV034mJ0tCM6b+8+InyrTTV4n9yyD/M
AFdcckDdnzvpAHkRuZgAtHntrooJ3DCdRqUDddcZqpKWRG/Wz7feW30GOIZ0TECS
ZwIDAQAB
-----END PUBLIC KEY-----`; 

const bobPrivateKey = `-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC0d/AlCAdLJGcx
3mBbkqXKxTK1wgs1nnYTuO7ny1TLgsRG7EmR+c3b0BXEAPCRFAxiqlQ+YPrmpxHZ
e1X4srESWaUoELKkeHWSk1q2WEbwNNf0oGGQa44vG5NYs3usgf5/j49jco9VlZAt
T82rjRLwujpIB0//Wu9OKhRH/1vwd1x1Q5MTP/9InCb4eSDJaWIUXo/4VbSnkr3+
MR29i0gVuuVwvyvYt8Kn+7ORl5UqCGwxlPMUyGaeiCWIRxuWaj1hNPh3hIj3g7cK
cARBilD8Twp6G3Pe3dujTJ4+SQVyACZRbG54/NGyd0KHWsE3wMHuxe5LjlNhZZim
AUsPhrMfAgMBAAECggEAPLCe/l0aUs9NsuwVXIZPIgc6G/zDF0eQbuaA1UvAWuZB
ipZY0XIAJD1wrGcif6+N0Lp2NToY9mtV6dz71vSE7uZdz8D5yqzF4UKTvYGnbY1f
2KD83nwFJ1tvLGPDogpfY1eMgYWbpUz0XQCa6me5aGJASkvHP9k9Y/xrsKC0MwPo
X9GPhxeQi2ut7wdjmA8xvp4fcBPFEPMAfhElRYbFLjWlQxQlkhcZTJujR4ABlrzB
tfBRtcbziFihSQ7w1yX3nLD6FPYQ4Jjd50cmAnCut60tjF/YMCI30D4z7FhrUexP
gtg+V76ovwYhztJSPhS0gSIkCMTcmOHwiMblRpuGPQKBgQDdMd2CnqxgCEm4Z0HL
Uftx6eYAH69By/JbmED4LnOjLE6DGwSo7nk99loJivG0fwz2s/8YOkBUdlUql0iO
ucGcqOWuOZoelqniZKxIxCkyFGaJKxOxBZLWbD860xEQUUYZdK4SErL+BGRnG0iD
F3rE0Nsp4H31YO0J7ADwZeQhcwKBgQDQ3YsFU3E9E8AtSp6AWgEHEWxzvAP7GvQW
Hkw9/XxUsIVhitvkgvaD3GgGBOn3eNz2iV5z99jh2bkOeH4Ph5JPt6WIMCZLnN2K
s5YgZgG5/fMqYKzu1MgRV5NWIsw3SSolfzlj5cNEYhSi4N6X9KtcsmtuKB0Enh86
u3i4IHVMpQKBgDZW3bgNCwO8hX/LvhoY1dCySVKWdhOP6sYdrThLERVw+Qi0RnzJ
uPdD4fKeM6rH24NvzKdDCDK3r0x7RdPqRmoaA/K9K+N/19RKLxjhN82ZvWbNMlU2
rVAH37Cv0W1UygfO5kSCW36TzaaWyUWLKxnWxUCQaeEyIolhdQmZvmWJAoGAXnwK
GsOvk1Cu/A4oe6m7k0X3iLeCGYMM7kCQfu5/4xPjksetR8dS2z3GtQpeCPxdAQ4N
c2qoaysCAyDQ7heHQZazRFN7z3LL6aXqAQgEOe4+pWoMcRJC202BslKVjWEEtufB
v4Y9+l5gNXqCV71wE8QGw1NUJTWerQQHzUuppJ0CgYA8zvHVhQoWvRRoZEhdmXll
NmFmoFrFpShETNc+aBeN/4vAtxCfyO6SFQaflMgBIHrAdHD7PVFRtsUWCCJ/hn6q
YOrHugO/xXaZKf9N/XIC25v/Rcpdxi+QUdadxfAOwGq9czn+blIRYBsvbbytZfs2
ZWRIDsmBVFd+DVsS4ISAhw==
-----END PRIVATE KEY-----`;

const recipientPrivateKey = crypto.createPrivateKey(bobPrivateKey);

const signature = '1233189a6d210ac531875fff508e91e8cd07bd8f0d1cd5ebfc1b217df81200048503be58d7ae25ab3a350b48b18548ddf8ac20710b60da9bb90a8d6387007ecdd502a0358080008a4d759171d9799633c82fea807e83d1e3e816e9250dd2e172eeae21aefdbb38512275d373642c68e66912b4fbf51485a2d97c2ee097525521ace32b0df5bf600843b1a2bb236c4bce78658d29bd12ef738176e880cedc62a48f8c60a96f040acd72b2586b6fda94529b9c9859b412b2904a790cde511c3f31a965d52359efb5f994dd029a70908758ade600c49d3b72f20e06c94112bf2ee04e3eed20d89ebee0be3e3c2766c3add2f8240f7da556b33f49eb271b9ef9cb78';
const ciphertextHex = '29e1540d94e2adb40c80932267d4c0059c114d1b5414793c709191414177d5fab2202a63218781c89e883760afa1fc0fef419e446535cb37c678389118e6121394dcebb3072587184c6b74387cadb6e291b308ba593bec06074b98ffe7a981086427e0cbebe1ce817b2cd977c443539bff93faa83c46a1cbcb9446b4997ead6800e7402456751a5e1846aaa1161bf1e617bbefc56b0e935ed822415c7fb898c6a4f013af924427cf065fea21eb97bb23a49b257be11a46e3b4186d6158ab2d0fbcb625bd76ce3df08325c9c5193fd7bba36b5b2e3a5e050b4816de7459d84a56eac457adef33f25d92593f0261b0683e0ed1ab54d3d64467a5a4dd6b4723484b';
const ciphertext = Buffer.from(ciphertextHex, "hex");

const recoveredPlaintext = crypto.privateDecrypt(recipientPrivateKey, ciphertext);


const verify = crypto.createVerify('SHA256');  
verify.update(recoveredPlaintext);  
verify.end();  
const isVerified = verify.verify(alicePublicKey, signature, 'hex');  


console.log(`Signature Verification: ${isVerified}`);  
console.log(`Message: ${recoveredPlaintext}`);  